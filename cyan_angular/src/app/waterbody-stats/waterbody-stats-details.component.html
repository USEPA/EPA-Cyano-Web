<div class="location_block_0">

	<div class="locations-block">

		<!-- <button mat-button (click)="exit();" class="locations-exit">X</button> -->
		<button mat-button [routerLink]="['']" class="locations-exit">X</button>

		<div>
			<h4>Waterbody Information</h4>
			
			<br>

			<div>
				<b>Object ID:</b> {{selectedWaterbody.objectid}}<br>
				<b>Name:</b> {{selectedWaterbody.name}}<br>
				<b>Centroid Latitude:</b> {{selectedWaterbody.centroid_lat}}<br>
				<b>Centroid Longitude:</b> {{selectedWaterbody.centroid_lng}}<br>
				<b>Area:</b> {{wbProps.areasqkm}} km<sup>2</sup><br>
			</div>

			<br>

			<div class="details_tab">
				<!-- User selections for WB stats -->
				<div class="data-item">
					<mat-form-field>
						<mat-label>Data Type</mat-label>
						<mat-select [(value)]="selectedDataType" (selectionChange)="updateDataType($event.value);">
							<mat-option value="daily">Daily</mat-option>
							<mat-option value="weekly">Weekly</mat-option>
						</mat-select>
					</mat-form-field>
					<br>
					<mat-form-field>
						<mat-label>Available Dates</mat-label>
							<mat-select [(value)]="selectedAvailableDate" (selectionChange)="updateDate($event.value);">
							<mat-option *ngFor="let date of wbStats.dates" [value]="date">
								{{date}}
							</mat-option>
						</mat-select>
					</mat-form-field>
					<br>
					<mat-form-field>
						<mat-label>Date Range</mat-label>
						<mat-select [(value)]="selectedDateRange" (selectionChange)="updateDateRange($event.value);">
							<mat-option value="single">Single</mat-option>
							<mat-option value="7day">7 Day</mat-option>
							<mat-option value="30day">30 Day</mat-option>
						</mat-select>
					</mat-form-field>
				</div>
				<!-- Shows list of dates within selected range -->
				<div *ngIf="selectedDateRange=='7day' || selectedDateRange=='30day'" id="selected-dates-div" class="data-item">
					<b>Selected dates</b>
					<dl id="selected-dates-list">
						<dt [class.hightlight-date]="date == selectedDate" class="selected-dates-item" *ngFor="let date of datesWithinRange">
							{{date}}
						</dt>
					</dl>
					<br>
					<div class="details_slideshow">
            <mat-checkbox color="primary" [(ngModel)]="slidershow" (change)="toggleSlideShow()">Slideshow</mat-checkbox>
          </div>
				</div>
			</div>

			<br>

			<div class="details_tab" *ngIf="plotStats">

				<!-- Total Cell Counts Plot -->
				<div class="data-item">
				  <div class="chart_header">
				    <div class="chart_title" class="chart-toggle" (click)="togglePlotType();">
							<mat-icon *ngIf="selectedDateRange=='single'">unfold_more</mat-icon>
							{{selectedPlotType}}
						</div>
				    <div class="chart_source_selection"></div>
				  </div>
					<div class="chart_graph">
						<canvas *ngIf="!showStacked && !showPie" aria-label="Total cell counts" baseChart class="cyan_chart" width="1" height="1"
						  [datasets]="chartData"
						  [options]="chartOptions"
						  [colors]="chartColors"
						  [legend]="chartLegend"
						  [chartType]="chartType"
						  [labels]="chartLabels"
						  (chartClick)="chartClick($event)">
						</canvas>
						<canvas *ngIf="!showStacked && !showBars" aria-label="Total cell counts" baseChart class="cyan_chart" width="1" height="1"
						  [datasets]="pieChartData"
						  [options]="pieChartOptions"
						  [colors]="pieChartColors"
						  [legend]="pieChartLegend"
						  [chartType]="pieChartType"
						  [labels]="pieChartLabels"
						  (chartClick)="chartClick($event)">
						</canvas>
						<canvas *ngIf="!showPie && !showBars" aria-label="Total cell counts" baseChart class="cyan_chart" width="1" height="1"
						  [datasets]="stackedChartData"
						  [options]="stackedChartOptions"
						  [colors]="stackedChartColors"
						  [legend]="stackedChartLegend"
						  [chartType]="stackedChartType"
						  [labels]="stackedChartLabels">
						</canvas>
					</div>
				</div>
				<!-- Cell Concentration Histogram -->
				<div class="data-item">
					<div *ngIf="!showStacked" class="chart_header">
					  <div class="chart_title">Cell Concentration Histogram</div>
					  <div class="chart_source_selection"></div>
					</div>
					<div *ngIf="showStacked" class="chart_header">
					  <div class="chart_title">Total Cell Counts by Range</div>
					  <div class="chart_source_selection"></div>
					</div>
					<div class="chart_graph">
						<canvas *ngIf="!showStacked" aria-label="Concentration histogram" baseChart class="cyan_chart" width="1" height="1"
						  [datasets]="histoChartData"
						  [options]="chartOptions"
						  [legend]="chartLegend"
						  [chartType]="histoChartType"
						  [labels]="histoChartLabels">
						</canvas>
						<canvas *ngIf="showStacked" aria-label="Total cell counts by range" baseChart class="cyan_chart" width="1" height="1"
						  [datasets]="lineChartData"
						  [options]="lineChartOptions"
						  [colors]="lineChartColors"
						  [legend]="lineChartLegend"
						  [chartType]="lineChartType"
						  [labels]="lineChartLabels">
						</canvas>
					</div>
				</div>

			</div>

			<div class="details_tab" *ngIf="calculatingStats">

				<!-- Displays WB stats for a selected date -->
				<div class="data-item">
					<b>Date:</b> {{wbStats.date}}<br>
					<b>Min:</b> {{wbStats.min}} cells/mL<br>
					<b>Max:</b> {{wbStats.max}} cells/mL<br>
					<b>Average:</b> {{wbStats.average}} cells/mL<br>
					<b>Standard Deviation:</b> {{wbStats.stddev}} cells/mL
				</div>

				<div *ngIf="!showStacked" class="data-item">
					<!-- Range selection -->
					<mat-form-field>
						<mat-label>Select range</mat-label>
						<mat-select [(value)]="selectedRange" (selectionChange)="updateHistoChart();">
							<mat-option value="low">Low</mat-option>
							<mat-option value="medium">Medium</mat-option>
							<mat-option value="high">High</mat-option>
							<mat-option value="veryHigh">Very High</mat-option>
							<mat-option value="all">All</mat-option>
						</mat-select>
					</mat-form-field>
					<!-- Stats -->
					<div>
						<b>Min:</b> {{rangeStats.min || "N/A"}} cells/mL<br>
						<b>Max:</b> {{rangeStats.max || "N/A"}} cells/mL<br>
						<b>Average:</b> {{rangeStats.average}} cells/mL<br>
						<b>Standard Deviation:</b> {{rangeStats.stddev}} cells/mL
					</div>
				</div>

			</div>

		</div>

	</div>

</div>

<!-- OCLI color map legend -->
<div style="float:right;">
	<div class="leaflet-container leaflet-bottom leaflet-left">
	  <span class="leaflet-control leaflet-control-attribution map-legend-toggle" (click)="toggleLegend()">Toggle Map Legend</span>
	</div>
	<div class="map-legend leaflet-top leaflet-left" *ngIf="showLegend">
	  <img src="assets/images/legend.png" />
	</div>
</div>